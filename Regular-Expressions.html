<!DOCTYPE HTML><html lang=en class="sidebar-visible no-js rust"><head><meta charset=UTF-8><title>Regular Expressions - Vim Reference Guide</title><meta content="text/html; charset=utf-8"http-equiv=Content-Type><meta name=description content="Vim Reference Guide"><meta name=viewport content="width=device-width, initial-scale=1"><meta name=theme-color content=#ffffff><link rel=icon href=favicon.svg><link rel="shortcut icon"href=favicon.png><link rel=stylesheet href=css/variables.css><link rel=stylesheet href=css/general.css><link rel=stylesheet href=css/chrome.css><link rel=stylesheet href=FontAwesome/css/font-awesome.css><link rel=stylesheet href=fonts/fonts.css><link rel=stylesheet href=highlight.css><link rel=stylesheet href=tomorrow-night.css><link rel=stylesheet href=ayu-highlight.css><link rel=stylesheet href=style.css><body><script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script><script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script><script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script><script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script><nav id=sidebar class=sidebar aria-label="Table of contents"><div class=sidebar-scrollbox><ol class=chapter><li class="chapter-item expanded affix"><a href=cover.html>Cover</a><li class="chapter-item expanded affix"><a href=buy.html>Buy PDF/EPUB versions</a><li class="chapter-item expanded affix"><a href=preface.html>Preface</a><li class="chapter-item expanded"><a href=Introduction.html><strong aria-hidden=true>1.</strong> Introduction</a><li class="chapter-item expanded"><a href=Insert-mode.html><strong aria-hidden=true>2.</strong> Insert mode</a><li class="chapter-item expanded"><a href=Normal-mode.html><strong aria-hidden=true>3.</strong> Normal mode</a><li class="chapter-item expanded"><a href=Command-line-mode.html><strong aria-hidden=true>4.</strong> Command-line mode</a><li class="chapter-item expanded"><a href=Visual-mode.html><strong aria-hidden=true>5.</strong> Visual mode</a><li class="chapter-item expanded"><a href=Regular-Expressions.html class=active><strong aria-hidden=true>6.</strong> Regular Expressions</a><li class="chapter-item expanded"><a href=Macro.html><strong aria-hidden=true>7.</strong> Macro</a><li class="chapter-item expanded"><a href=Customizing-Vim.html><strong aria-hidden=true>8.</strong> Customizing Vim</a><li class="chapter-item expanded"><a href=CLI-options.html><strong aria-hidden=true>9.</strong> CLI options</a></li><br><hr><li class="chapter-item expanded"><i id=git-repository-button class="fa fa-github"></i><a href=https://github.com/learnbyexample/vim_reference>   Source code</a><li class="chapter-item expanded"><i id=home-button class="fa fa-home"></i><a href=https://learnbyexample.github.io/>   My Blog</a><li class="chapter-item expanded"><i id=book-button class="fa fa-book"></i><a href=https://learnbyexample.github.io/books/>   My Books</a><li class="chapter-item expanded"><i id=mail-button class="fa fa-envelope"></i><a href=https://learnbyexample.gumroad.com/l/learnbyexample-weekly>   learnbyexample weekly</a></ol></div><div id=sidebar-resize-handle class=sidebar-resize-handle></div></nav><div id=page-wrapper class=page-wrapper><div class=page><div id=menu-bar-hover-placeholder></div><div id=menu-bar class="menu-bar sticky bordered"><div class=left-buttons><button id=sidebar-toggle class=icon-button type=button title="Toggle Table of Contents"aria-label="Toggle Table of Contents"aria-controls=sidebar><i class="fa fa-bars"></i></button><button id=theme-toggle class=icon-button type=button title="Change theme"aria-label="Change theme"aria-haspopup=true aria-expanded=false aria-controls=theme-list><i class="fa fa-paint-brush"></i></button><ul id=theme-list class=theme-popup aria-label=Themes role=menu><li role=none><button role=menuitem class=theme id=light>Light</button><li role=none><button role=menuitem class=theme id=rust>Rust (default)</button><li role=none><button role=menuitem class=theme id=coal>Coal</button><li role=none><button role=menuitem class=theme id=navy>Navy</button><li role=none><button role=menuitem class=theme id=ayu>Ayu</button></ul><button id=search-toggle class=icon-button type=button title="Search. (Shortkey: s)"aria-label="Toggle Searchbar"aria-expanded=false aria-keyshortcuts=S aria-controls=searchbar><i class="fa fa-search"></i></button></div><h1 class=menu-title>Vim Reference Guide</h1><div class=right-buttons><a href=https://learnbyexample.github.io title=Blog aria-label=Blog> <i id=home-button class="fa fa-home"></i> </a><a href=https://github.com/learnbyexample/vim_reference title="Git repository"aria-label="Git repository"> <i id=git-repository-button class="fa fa-github"></i> </a></div></div><div id=search-wrapper class=hidden><form id=searchbar-outer class=searchbar-outer><input type=search id=searchbar name=searchbar placeholder="Search this book ..."aria-controls=searchresults-outer aria-describedby=searchresults-header></form><div id=searchresults-outer class="searchresults-outer hidden"><div id=searchresults-header class=searchresults-header></div><ul id=searchresults></ul></div></div><script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script><div id=content class=content><main><div class=sidetoc><nav class=pagetoc></nav></div><h1 id=regular-expressions><a class=header href=#regular-expressions>Regular Expressions</a></h1><p>This chapter will discuss regular expressions (regexp) and related features in detail. As discussed in earlier chapters:<ul><li><code>/searchpattern</code> search the given pattern in the forward direction<li><code>?searchpattern</code> search the given pattern in the backward direction<li><code>:range s/searchpattern/replacestring/flags</code> search and replace <ul><li><code>:s</code> is short for <code>:substitute</code> command<li>the delimiter after <code>replacestring</code> is optional if you are not using flags</ul></ul><p><strong>Documentation links</strong>:<ul><li><a href=https://vimhelp.org/usr_27.txt.html>:h usr_27.txt</a> — search commands and patterns<li><a href=https://vimhelp.org/pattern.txt.html>:h pattern-searches</a> — reference manual for Patterns and search commands<li><a href=https://vimhelp.org/change.txt.html#complex-change>:h complex-change</a> — reference manual for Complex changes</ul><h2 id=flags><a class=header href=#flags>Flags</a></h2><ul><li><code>g</code> replace all occurrences within a matching line <ul><li>by default, only the first matching portion will be replaced</ul><li><code>c</code> ask for confirmation before each replacement<li><code>i</code> ignore case for <code>searchpattern</code><li><code>I</code> don't ignore case for <code>searchpattern</code></ul><p>These flags are applicable for the substitute command but not <code>/</code> or <code>?</code> searches. Flags can also be combined, for example:<ul><li><code>s/cat/Dog/gi</code> replace every occurrence of <code>cat</code> with <code>Dog</code> <ul><li>Case is ignored, so <code>Cat</code>, <code>cAt</code>, <code>CAT</code>, etc will also be replaced<li>Note that <code>i</code> doesn't affect the case of the replacement string</ul></ul><blockquote><p><img src=./images/info.svg alt=info> See <a href=https://vimhelp.org/change.txt.html#%3As_flags>:h s_flags</a> for a complete list of flags and more details about them.</blockquote><h2 id=anchors><a class=header href=#anchors>Anchors</a></h2><p>By default, regexp will match anywhere in the text. You can use line and word anchors to specify additional restrictions regarding the position of matches. These restrictions are made possible by assigning special meaning to certain characters and escape sequences. The characters with special meaning are known as <strong>metacharacters</strong> in regular expressions parlance. In case you need to match those characters literally, you need to escape them with a <code>\</code> (discussed in <strong>Escaping metacharacters</strong> section later in this chapter).<ul><li><code>^</code> restricts the match to the start of line <ul><li><code>^This</code> matches <code>This is a sample</code> but not <code>Do This</code></ul><li><code>$</code> restricts the match to end-of-line <ul><li><code>)$</code> matches <code>apple (5)</code> but not <code>def greeting():</code></ul><li><code>^$</code> match empty line<li><code>\&LTpattern</code> restricts the match to the start of a word <ul><li>word characters include alphabets, digits and underscore<li><code>\&LThis</code> matches <code>his</code> or <code>to-his</code> or <code>history</code> but not <code>this</code> or <code>_hist</code></ul><li><code>pattern\></code> restricts the match to the end of a word <ul><li><code>his\></code> matches <code>his</code> or <code>to-his</code> or <code>this</code> but not <code>history</code> or <code>_hist</code></ul><li><code>\&LTpattern\></code> restricts the match between start of a word and end of a word <ul><li><code>\&LThis\></code> matches <code>his</code> or <code>to-his</code> but not <code>this</code> or <code>history</code> or <code>_hist</code></ul></ul><blockquote><p><img src=./images/info.svg alt=info> End-of-line can be <code>\r</code> (carriage return), <code>\n</code> (newline) or <code>\r\n</code> depending on your system and <code>fileformat</code> setting.</blockquote><blockquote><p><img src=./images/info.svg alt=info> See <a href=https://vimhelp.org/pattern.txt.html#pattern-atoms>:h pattern-atoms</a> for more details.</blockquote><h2 id=dot-metacharacter><a class=header href=#dot-metacharacter>Dot metacharacter</a></h2><ul><li><code>.</code> match any single character other than end-of-line <ul><li><code>c.t</code> matches <code>cat</code> or <code>cot</code> or <code>c2t</code> or <code>c^t</code> or <code>c.t</code> or <code>c;t</code> but not <code>cant</code> or <code>act</code> or <code>sit</code></ul><li><code>\_.</code> match any single character, including end-of-line <ul><li>you'll later see how <code>\_</code> is used in many more places to include end-of-line in the matches</ul></ul><h2 id=greedy-quantifiers><a class=header href=#greedy-quantifiers>Greedy Quantifiers</a></h2><p>Quantifiers can be applied to literal characters, dot metacharacter, groups, backreferences and character classes. Basic examples are shown below, more will be discussed later.<ul><li><code>*</code> match zero or more times <ul><li><code>abc*</code> matches <code>ab</code> or <code>abc</code> or <code>abccc</code> or <code>abcccccc</code> but not <code>bc</code><li><code>Error.*valid</code> matches <code>Error: invalid input</code> but not <code>valid Error</code><li><code>s/a.*b/X/</code> replaces <code>table bottle bus</code> with <code>tXus</code> since <code>a.*b</code> matches from the first <code>a</code> to the last <code>b</code></ul><li><code>\+</code> match one or more times <ul><li><code>abc\+</code> matches <code>abc</code> or <code>abccc</code> but not <code>ab</code> or <code>bc</code></ul><li><code>\?</code> match zero or one times <ul><li><code>\=</code> can also be used<li><code>abc\?</code> matches <code>ab</code> or <code>abc</code>. This will match <code>abccc</code> or <code>abcccccc</code> as well, but only the <code>abc</code> portion<li><code>s/abc\?/X/</code> replaces <code>abcc</code> with <code>Xc</code></ul><li><code>\{m,n}</code> match <code>m</code> to <code>n</code> times (inclusive) <ul><li><code>ab\{1,4}c</code> matches <code>abc</code> or <code>abbc</code> or <code>xabbbcz</code> but not <code>ab</code> or <code>abbbbbc</code></ul><li><code>\{m,}</code> match at least <code>m</code> times <ul><li><code>ab\{3,}c</code> matches <code>xabbbcz</code> or <code>abbbbbc</code> but not <code>ab</code> or <code>abc</code> or <code>abbc</code></ul><li><code>\{,n}</code> match up to <code>n</code> times (including <code>0</code> times) <ul><li><code>ab\{,2}c</code> matches <code>abc</code> or <code>ac</code> or <code>abbc</code> but not <code>xabbbcz</code> or <code>abbbbbc</code></ul><li><code>\{n}</code> match exactly <code>n</code> times <ul><li><code>ab\{3}c</code> matches <code>xabbbcz</code> but not <code>abbc</code> or <code>abbbbbc</code></ul></ul><p>Greedy quantifiers will consume as <em>much</em> as possible, provided the overall pattern is also matched. That's how the <code>Error.*valid</code> example worked. If <code>.*</code> had consumed everything after <code>Error</code>, there wouldn't be any more characters to try to match <code>valid</code>. How the regexp engine handles matching varying amount of characters depends on the implementation details (backtracking, NFA, etc).<blockquote><p><img src=./images/info.svg alt=info> See <a href=https://vimhelp.org/pattern.txt.html#pattern-overview>:h pattern-overview</a> for more details.</blockquote><blockquote><p><img src=./images/info.svg alt=info> If you are familiar with other regular expression flavors like Perl, Python, etc, you'd be surprised by the use of <code>\</code> in the above examples. If you use <code>\v</code> very magic modifier (discussed later in this chapter), the <code>\</code> won't be needed.</blockquote><h2 id=non-greedy-quantifiers><a class=header href=#non-greedy-quantifiers>Non-greedy Quantifiers</a></h2><p>Non-greedy quantifiers match as <em>minimally</em> as possible.<ul><li><code>\{-}</code> match zero or more times as minimally as possible <ul><li><code>s/t.\{-}a/X/g</code> replaces <code>that is quite a fabricated tale</code> with <code>XX fabricaXle</code> <ul><li>the matching portions are <code>tha</code>, <code>t is quite a</code> and <code>ted ta</code></ul><li><code>s/t.*a/X/g</code> replaces <code>that is quite a fabricated tale</code> with <code>Xle</code> since <code>*</code> is greedy</ul><li><code>\{-m,n}</code> match <code>m</code> to <code>n</code> times as minimally as possible <ul><li><code>m</code> or <code>n</code> can be left out as seen in the Greedy Quantifiers section<li><code>s/.\{-2,5}/X/</code> replaces <code>123456789</code> with <code>X3456789</code> (here <code>.</code> matched 2 times)<li><code>s/.\{-2,5}6/X/</code> replaces <code>123456789</code> with <code>X789</code> (here <code>.</code> matched 5 times to satisfy overall pattern)</ul></ul><blockquote><p><img src=./images/info.svg alt=info> See <a href=https://vimhelp.org/pattern.txt.html#pattern-overview>:h pattern-overview</a> and <a href=https://stackoverflow.com/q/1305853/4082052>stackoverflow: non-greedy matching</a> for more details.</blockquote><h2 id=character-classes><a class=header href=#character-classes>Character Classes</a></h2><p>To create a custom placeholder for limited set of characters, enclose them inside <code>[]</code> metacharacters. Character classes have their own versions of metacharacters and provide special predefined sets for common use cases.<ul><li><code>[aeiou]</code> match any lowercase vowel character<li><code>[^aeiou]</code> match any character other than lowercase vowels<li><code>[a-d]</code> match any of <code>a</code> or <code>b</code> or <code>c</code> or <code>d</code> <ul><li>the range metacharacter <code>-</code> can be applied between any two characters</ul><li><code>\a</code> match any alphabet character <code>[a-zA-Z]</code><li><code>\A</code> match other than alphabets <code>[^a-zA-Z]</code><li><code>\l</code> match lowercase alphabets <code>[a-z]</code><li><code>\L</code> match other than lowercase alphabets <code>[^a-z]</code><li><code>\u</code> match uppercase alphabets <code>[A-Z]</code><li><code>\U</code> match other than uppercase alphabets <code>[^A-Z]</code><li><code>\d</code> match any digit character <code>[0-9]</code><li><code>\D</code> match other than digits <code>[^0-9]</code><li><code>\o</code> match any octal character <code>[0-7]</code><li><code>\O</code> match other than octals <code>[^0-7]</code><li><code>\x</code> match any hexademical character <code>[0-9a-fA-F]</code><li><code>\X</code> match other than hexademicals <code>[^0-9a-fA-F]</code><li><code>\w</code> match any word character (alphabets, digits, underscore) <code>[a-zA-Z0-9_]</code> <ul><li>this word definition is same as seen earlier with word boundaries</ul><li><code>\W</code> match other than word characters <code>[^a-zA-Z0-9_]</code><li><code>\s</code> match space and tab characters <code>[ \t]</code><li><code>\S</code> match other than space and tab characters <code>[^ \t]</code></ul><p>Here are some examples with character classes:<ul><li><code>c[ou]t</code> matches <code>cot</code> or <code>cut</code><li><code>\<[ot][on]\></code> matches <code>oo</code> or <code>on</code> or <code>to</code> or <code>tn</code> as whole words only<li><code>^[on]\{2,}$</code> matches <code>no</code> or <code>non</code> or <code>noon</code> or <code>on</code> etc as whole lines only<li><code>s/"[^"]\+"/X/g</code> replaces <code>"mango" and "(guava)"</code> with <code>X and X</code><li><code>s/\d\+/-/g</code> replaces <code>Sample123string777numbers</code> with <code>Sample-string-numbers</code><li><code>s/\&LT0*[1-9]\d\{2,}\>/X/g</code> replaces <code>0501 035 26 98234</code> with <code>X 035 26 X</code> (matches numbers >=100 with optional leading zeros)<li><code>s/\W\+/ /g</code> replaces <code>load2;err_msg--\ant</code> with <code>load2 err_msg ant</code></ul><blockquote><p><img src=./images/info.svg alt=info> To include the end-of-line character, use <code>\_</code> instead of <code>\</code> for any of the above escape sequences. For example, <code>\_s</code> will help you match across lines. Similarly, use <code>\_[]</code> for bracketed classes.</blockquote><blockquote><p><img src=./images/warning.svg alt=warning> The above escape sequences do not have special meaning within bracketed classes. For example, <code>[\d\s]</code> will only match <code>\</code> or <code>d</code> or <code>s</code>.</blockquote><blockquote><p><img src=./images/info.svg alt=info> See <a href=https://vimhelp.org/pattern.txt.html#%2Fcharacter-classes>:h character-classes</a> for more details.</blockquote><h2 id=alternation-and-grouping><a class=header href=#alternation-and-grouping>Alternation and Grouping</a></h2><p>Alternation helps you to match multiple terms and they can have their own anchors as well (since each alternative is a regexp pattern). Often, there are some common things among the regular expression alternatives. In such cases, you can group them using a pair of parentheses metacharacters. Similar to <code>a(b+c)d = abd+acd</code> in maths, you get <code>a(b|c)d = abd|acd</code> in regular expressions.<ul><li><code>\|</code> match either of the specified patterns <ul><li><code>min\|max</code> matches <code>min</code> or <code>max</code><li><code>one\|two\|three</code> matches <code>one</code> or <code>two</code> or <code>three</code><li><code>\&LTpar\>\|er$</code> matches whole word <code>par</code> or a line ending with <code>er</code></ul><li><code>\(pattern\)</code> group a pattern to apply quantifiers, create a terser regexp by taking out common elements, etc <ul><li><code>a\(123\|456\)b</code> is equivalent to <code>a123b\|a456b</code><li><code>hand\(y\|ful\)</code> matches <code>handy</code> or <code>handful</code><li><code>hand\(y\|ful\)\?</code> matches <code>hand</code> or <code>handy</code> or <code>handful</code><li><code>\(to\)\+</code> matches <code>to</code> or <code>toto</code> or <code>tototo</code> and so on<li><code>re\(leas\|ceiv\)\?ed</code> matches <code>reed</code> or <code>released</code> or <code>received</code></ul></ul><p>There's some tricky situations when using alternation. Say, you want to match <code>are</code> or <code>spared</code> — which one should get precedence? The bigger word <code>spared</code> or the substring <code>are</code> inside it or based on something else? The alternative which matches earliest in the input gets precedence, irrespective of the order of the alternatives.<ul><li><code>s/are\|spared/X/g</code> will replace <code>rare spared area</code> with <code>rX X Xa</code> <ul><li><code>s/spared\|are/X/g</code> will also give the same results</ul></ul><p>In case of matches starting from the same location, for example <code>spa</code> and <code>spared</code>, the leftmost alternative gets precedence. Sort by longest term first if don't want shorter terms to take precedence.<ul><li><code>s/spa\|spared/**/g</code> will replace <code>spared spare</code> with <code>**red **re</code><li><code>s/spared\|spa/**/g</code> will replace <code>spared spare</code> with <code>** **re</code></ul><h2 id=backreference><a class=header href=#backreference>Backreference</a></h2><p>The groupings seen in the previous section are also known as <strong>capture groups</strong>. The string captured by these groups can be referred later using backreference <code>\N</code> where <code>N</code> is the capture group you want. Backreferences can be used in both search and replacement sections.<ul><li><code>\(pattern\)</code> capture group for later use via backreferences<li><code>\%(pattern\)</code> non-capturing group<li>leftmost group is <code>1</code>, second leftmost group is <code>2</code> and so on (maximum <code>9</code> groups)<li><code>\1</code> backreference to the first capture group<li><code>\2</code> backreference to the second capture group<li><code>\9</code> backreference to the ninth capture group<li><code>&</code> or <code>\0</code> backreference to the entire matched portion</ul><p>Here are some examples:<ul><li><code>\(\a\)\1</code> matches two consecutive repeated alphabets like <code>ee</code>, <code>TT</code>, <code>oo</code> and so on <ul><li>recall that <code>\a</code> refers to <code>[a-zA-Z]</code></ul><li><code>\(\a\)\1\+</code> matches two or more consecutive repeated alphabets like <code>ee</code>, <code>ttttt</code>, <code>OOOOOOOO</code> and so on<li><code>s/\d\+/(&)/g</code> replaces <code>52 apples 31 mangoes</code> with <code>(52) apples (31) mangoes</code> (surround digits with parentheses)<li><code>s/\(\w\+\),\(\w\+\)/\2,\1/g</code> replaces <code>good,bad 42,24</code> with <code>bad,good 24,42</code> (swap words separated by comma)<li><code>s/\(_\)\?_/\1/g</code> replaces <code>_foo_ __123__ _baz_</code> with <code>foo _123_ baz</code> (matches one or two underscores, deletes one underscore)<li><code>s/\(\d\+\)\%(abc\)\+\(\d\+\)/\2:\1/</code> replaces <code>12abcabcabc24</code> with <code>24:12</code> (matches digits separated by one or more <code>abc</code> sequences, swaps the numbers with <code>:</code> as the separator) <ul><li>note the use of non-capturing group for <code>abc</code> since it isn't required for backreferencing<li><code>s/\(\d\+\)\(abc\)\+\(\d\+\)/\3:\1/</code> does the same if only capturing groups are used</ul></ul><h2 id=lookarounds><a class=header href=#lookarounds>Lookarounds</a></h2><p>Lookarounds help to create custom anchors and add conditions within the <code>searchpattern</code>. These assertions are also known as <strong>zero-width patterns</strong> because they add restrictions similar to anchors and are not part of the matched portions.<blockquote><p><img src=./images/info.svg alt=info> Vim's syntax is different than those usually found in programming languages like Perl, Python and JavaScript. The syntax starting with <code>\@</code> is always added as a suffix to the pattern atom used in the assertion. For example, <code>(?!\d)</code> and <code>(?<=pat.*)</code> in other languages are specified as <code>\d\@!</code> and <code>\(pat.*\)\@<=</code> respectively in Vim.</blockquote><ul><li><code>\@!</code> negative lookahead assertion <ul><li><code>ice\d\@!</code> matches <code>ice</code> as long as it is <em>not</em> immediately followed by a digit character, for example <code>ice</code> or <code>iced!</code> or <code>icet5</code> or <code>ice.123</code> but not <code>ice42</code> or <code>ice123</code><li><code>s/ice\d\@!/X/g</code> replaces <code>iceiceice2</code> with <code>XXice2</code><li><code>s/par\(.*\&LTpar\>\)\@!/X/g</code> replaces <code>par</code> with <code>X</code> as long as whole word <code>par</code> is <em>not</em> present later in the line, for example <code>parse and par and sparse</code> is converted to <code>parse and X and sXse</code><li><code>at\(\(go\)\@!.\)*par</code> matches <code>cat,dog,parrot</code> but not <code>cat,god,parrot</code> (i.e. match <code>at</code> followed by <code>par</code> as long as <code>go</code> isn't present in between, this is an example of <em>negating a grouping</em>)</ul><li><code>\@&LT!</code> negative lookbehind assertion <ul><li><code>_\@&LT!ice</code> matches <code>ice</code> as long as it is <em>not</em> immediately preceded by a <code>_</code> character, for example <code>ice</code> or <code>_(ice)</code> or <code>42ice</code> but not <code>_ice</code><li><code>\(cat.*\)\@&LT!dog</code> matches <code>dog</code> as long as <code>cat</code> is <em>not</em> present earlier in the line, for example <code>fox,parrot,dog,cat</code> but not <code>fox,cat,dog,parrot</code></ul><li><code>\@=</code> positive lookahead assertion <ul><li><code>ice\d\@=</code> matches <code>ice</code> as long as it is immediately followed by a digit character, for example <code>ice42</code> or <code>ice123</code> but not <code>ice</code> or <code>iced!</code> or <code>icet5</code> or <code>ice.123</code><li><code>s/ice\d\@=/X/g</code> replaces <code>ice ice_2 ice2 iced</code> with <code>ice ice_2 X2 iced</code></ul><li><code>\@<=</code> positive lookbehind assertion <ul><li><code>_\@<=ice</code> matches <code>ice</code> as long as it is immediately preceded by a <code>_</code> character, for example <code>_ice</code> or <code>(_ice)</code> but not <code>ice</code> or <code>_(ice)</code> or <code>42ice</code></ul></ul><h2 id=atomic-grouping><a class=header href=#atomic-grouping>Atomic Grouping</a></h2><p>As discussed earlier, both greedy and non-greedy quantifiers will try to satisfy the overall pattern by varying the amount of characters matched by the quantifiers. You can use atomic grouping if you do not want a specific sub-pattern to ever give back characters it has already matched. Similar to lookarounds, you need to use <code>\@></code> as a suffix, for example <code>\(pattern\)\@></code>.<ul><li><code>s/\(0*\)\@>\d\{3,\}/(&)/g</code> replaces only numbers >= 100 irrespective of any number of leading zeros, for example <code>0501 035 154</code> is converted to <code>(0501) 035 (154)</code> <ul><li><code>\(0*\)\@></code> will match the <code>0</code> character zero or more times, but it will not give up this portion to satisfy overall pattern<li><code>s/0*\d\{3,\}/(&)/g</code> will replace <code>0501 035 154</code> with <code>(0501) (035) (154)</code> (here <code>035</code> is matched because <code>0*</code> will match zero times to satisfy the overall pattern)</ul></ul><blockquote><p><img src=./images/info.svg alt=info> Some regexp engines provide this feature as <strong>possessive quantifiers</strong>.</blockquote><h2 id=set-start-and-end-of-the-match><a class=header href=#set-start-and-end-of-the-match>Set start and end of the match</a></h2><p>Some of the positive lookbehind and lookahead usage can be replaced with <code>\zs</code> and <code>\ze</code> respectively.<ul><li><code>\zs</code> set the start of the match (portion before <code>\zs</code> won't be part of the match) <ul><li><code>s/\<\w\zs\w*\W*//g</code> replaces <code>sea eat car rat eel tea</code> with <code>secret</code><li>same as <code>s/\(\<\w\)\@<=\w*\W*//g</code> or <code>s/\(\<\w\)\w*\W*/\1/g</code></ul><li><code>\ze</code> set the end of the match (portion after <code>\ze</code> won't be part of the match) <ul><li><code>s/ice\ze\d/X/g</code> replaces <code>ice ice_2 ice2 iced</code> with <code>ice ice_2 X2 iced</code><li>same as <code>s/ice\d\@=/X/g</code> or <code>s/ice\(\d\)/X\1/g</code></ul></ul><blockquote><p><img src=./images/info.svg alt=info> As per <a href=https://vimhelp.org/pattern.txt.html#%2F%5Czs>:h \zs</a> and <a href=https://vimhelp.org/pattern.txt.html#%2F%5Cze>:h \ze</a>, these "Can be used multiple times, the last one encountered in a matching branch is used."</blockquote><h2 id=magic-modifiers><a class=header href=#magic-modifiers>Magic modifiers</a></h2><p>These escape sequences change certain aspects of the syntax and behavior of the search pattern that comes after such a modifier. You can use multiple such modifiers as needed for particular sections of the pattern.<h3 id=magic-and-nomagic><a class=header href=#magic-and-nomagic>Magic and nomagic</a></h3><ul><li><code>\m</code> magic mode (this is the default setting)<li><code>\M</code> nomagic mode <ul><li><code>.</code>, <code>*</code> and <code>~</code> are no longer metacharacters (compared to magic mode)<li><code>\.</code>, <code>\*</code> and <code>\~</code> will make them to behave as metacharacters<li><code>^</code> and <code>$</code> would still behave as metacharacters<li><code>\Ma.b</code> matches only <code>a.b</code><li><code>\Ma\.b</code> matches <code>a.b</code> as well as <code>a=b</code> or <code>a&LTb</code> or <code>acd</code> etc</ul></ul><h3 id=very-magic><a class=header href=#very-magic>Very magic</a></h3><p>The default syntax of Vim regexp has only a few metacharacters like <code>.</code>, <code>*</code>, <code>^</code> and so on. If you are familiar with regexp usage in programming languages such as Perl, Python and JavaScript, you can use <code>\v</code> to get a similar syntax in Vim. This will allow the use of more metacharacters such as <code>()</code>, <code>{}</code>, <code>+</code>, <code>?</code> and so on without having to prefix them with a <code>\</code> metacharacter. From <a href=https://vimhelp.org/pattern.txt.html#%2Fmagic>:h magic</a> documentation:<blockquote><p>Use of <code>\v</code> means that after it, all ASCII characters except <code>0</code>-<code>9</code>, <code>a</code>-<code>z</code>, <code>A</code>-<code>Z</code> and <code>_</code> have special meaning</blockquote><ul><li><code>\v&LThis></code> matches <code>his</code> or <code>to-his</code> but not <code>this</code> or <code>history</code> or <code>_hist</code><li><code>a&LTb.*\v&LTend></code> matches <code>c=a&LTb #end</code> but not <code>c=a&LTb #bending</code> <ul><li>note that <code>\v</code> is used after <code>a&LTb</code> to avoid having to escape <code><</code></ul><li><code>\vone|two|three</code> matches <code>one</code> or <code>two</code> or <code>three</code><li><code>\vabc+</code> matches <code>abc</code> or <code>abccc</code> but not <code>ab</code> or <code>bc</code><li><code>s/\vabc?/X/</code> replaces <code>abcc</code> with <code>Xc</code><li><code>s/\vt.{-}a/X/g</code> replaces <code>that is quite a fabricated tale</code> with <code>XX fabricaXle</code><li><code>\vab{3}c</code> matches <code>xabbbcz</code> but not <code>abbc</code> or <code>abbbbbc</code><li><code>s/\v(\w+),(\w+)/\2,\1/g</code> replaces <code>good,bad 42,24</code> with <code>bad,good 24,42</code> <ul><li>compare this to default syntax: <code>s/\(\w\+\),\(\w\+\)/\2,\1/g</code></ul></ul><h3 id=very-nomagic><a class=header href=#very-nomagic>Very nomagic</a></h3><p>From <a href=https://vimhelp.org/pattern.txt.html#%2Fmagic>:h magic</a> documentation:<blockquote><p>Use of <code>\V</code> means that after it, only a backslash and terminating character (usually <code>/</code> or <code>?</code>) have special meaning</blockquote><ul><li><code>\V^.*{}$</code> matches <code>^.*{}$</code> literally<li><code>\V^.*{}$\.\*abcd</code> matches <code>^.*{}$</code> literally only if <code>abcd</code> is found later in the line <ul><li><code>\V^.*{}$\m.*abcd</code> can also be used</ul><li><code>\V\^This</code> matches <code>This is a sample</code> but not <code>Do This</code><li><code>\V)\$</code> matches <code>apple (5)</code> but not <code>def greeting():</code></ul><h2 id=case-sensitivity><a class=header href=#case-sensitivity>Case sensitivity</a></h2><p>These will override flags and settings, if any. Unlike the magic modifiers, you cannot apply <code>\c</code> or <code>\C</code> for a specific portion of the pattern.<ul><li><code>\c</code> case insensitive search <ul><li><code>\cthis</code> matches <code>this</code> or <code>This</code> or <code>THIs</code> and so on <ul><li><code>th\cis</code> or <code>this\c</code> and so on will also result in the same behavior</ul></ul><li><code>\C</code> case sensitive search <ul><li><code>\Cthis</code> match exactly <code>this</code> but not <code>This</code> or <code>THIs</code> and so on <ul><li><code>th\Cis</code> or <code>this\C</code> and so on will also result in the same behavior</ul><li><code>s/\Ccat/dog/gi</code> will replace <code>cat Cat CAT</code> with <code>dog Cat CAT</code> since <code>\C</code> overrides <code>i</code> flag</ul></ul><h2 id=changing-case><a class=header href=#changing-case>Changing Case</a></h2><p>These can be used in the replacement section:<ul><li><code>\u</code> Uppercases the next character<li><code>\U</code> UPPERCASES the following characters<li><code>\l</code> lowercases the next character<li><code>\L</code> lowercases the following characters<li><code>\e</code> or <code>\E</code> will end further case changes<li><code>\L</code> or <code>\U</code> will also override any existing conversion</ul><p>Examples:<ul><li><code>s/\<\l/\u&/g</code> replaces <code>hello. how are you?</code> with <code>Hello. How Are You?</code> <ul><li>recall that <code>\l</code> in the search section is equivalent to <code>[a-z]</code></ul><li><code>s/\<\L/\l&/g</code> replaces <code>HELLO. HOW ARE YOU?</code> with <code>hELLO. hOW aRE yOU?</code> <ul><li>recall that <code>\L</code> in the search section is equivalent to <code>[A-Z]</code></ul><li><code>s/\v(\l)_(\l)/\1\u\2/g</code> replaces <code>_foo aug_price next_line</code> with <code>_foo augPrice nextLine</code><li><code>s/.*/\L&/</code> replaces <code>HaVE a nICe dAy</code> with <code>have a nice day</code><li><code>s/\a\+/\u\L&/g</code> replaces <code>HeLLo:bYe gOoD:beTTEr</code> with <code>Hello:Bye Good:Better</code> <ul><li><code>s/\a\+/\L\u&/g</code> can also be used in this case</ul><li><code>s/\v(\a+)(:\a+)/\L\1\U\2/g</code> replaces <code>HeLLo:bYe gOoD:beTTEr</code> with <code>hello:BYE good:BETTER</code></ul><h2 id=alternate-delimiters><a class=header href=#alternate-delimiters>Alternate delimiters</a></h2><p>From <a href=https://vimhelp.org/change.txt.html#%3Asubstitute>:h substitute</a> documentation:<blockquote><p>Instead of the <code>/</code> which surrounds the pattern and replacement string, you can use any other single-byte character, but not an alphanumeric character, <code>\</code>, <code>"</code> or <code>|</code>. This is useful if you want to include a <code>/</code> in the search pattern or replacement string.</blockquote><ul><li><code>s#/home/learnbyexample/#\~/#</code> replaces <code>/home/learnbyexample/reports</code> with <code>~/reports</code> <ul><li>compare this with <code>s/\/home\/learnbyexample\//\~\//</code></ul></ul><h2 id=escape-sequences><a class=header href=#escape-sequences>Escape sequences</a></h2><ul><li><code>\t</code> tab character<li><code>\b</code> backspace character<li><code>\r</code> matches carriage return for <code>searchpattern</code>, produces newline for <code>replacestring</code><li><code>\n</code> matches end-of-line for <code>searchpattern</code>, produces ASCII NUL for <code>replacestring</code> <ul><li><code>\n</code> can also match <code>\r</code> or <code>\r\n</code> (where <code>\r</code> is carriage return) depending upon <code>fileformat</code> setting</ul><li><code>\%d</code> matches character specified by demical digits <ul><li><code>\%d39</code> matches the single quote character</ul><li><code>\%o</code> matches character specified by octal digits <ul><li><code>\%o47</code> matches the single quote character</ul><li><code>\%x</code> matches character specified by hexademical digits (max 2 digits) <ul><li><code>\%x27</code> matches the single quote character</ul><li><code>\%u</code> matches character specified by hexademical digits (max 4 digits)<li><code>\%U</code> matches character specified by hexademical digits (max 8 digits)</ul><blockquote><p><img src=./images/info.svg alt=info> Using <code>\%</code> sequences to insert characters in <code>replacestring</code> hasn't been implemented yet. See <a href=https://vi.stackexchange.com/q/10087/1616>vi.stackexchange: Replace with hex character</a> for workarounds.</blockquote><blockquote><p><img src=./images/info.svg alt=info> See <a href=https://ascii.cl/>ASCII code table</a> for a handy cheatsheet with all the ASCII characters and conversion tables.</blockquote><h2 id=escaping-metacharacters><a class=header href=#escaping-metacharacters>Escaping metacharacters</a></h2><p>To match the metacharacters literally (including character class metacharacters like <code>-</code>), i.e. to remove their special meaning, prefix those characters with a <code>\</code> (backslash) character. To indicate a literal <code>\</code> character, use <code>\\</code>. Depending on the pattern, you can also use a different magic modifier to reduce the need for escaping. Assume default magicness for the below examples unless otherwise specified.<ul><li><code>^</code> and <code>$</code> do not require escaping if they are used out of position <ul><li><code>b^2</code> will match <code>a^2 + b^2 - C*3</code><li><code>$4</code> will match <code>this ebook is priced $40</code><li><code>\^super</code> will match <code>^superscript</code> (you need to escape here since <code>^</code> is at the customary position)</ul><li><code>[</code> and <code>]</code> do not require escaping if only one of them is used <ul><li><code>b[1</code> will match <code>ab[123</code><li><code>42]</code> will match <code>xyz42] =</code><li><code>b\[123]</code> or <code>b[123\]</code> will match <code>ab[123] = d</code></ul><li><code>\Va*b.c</code> or <code>a\*b\.c</code> will match <code>a*b.c</code></ul><p>The following can be used to match character class metacharacters literally in addition to escaping them with a <code>\</code> character:<ul><li><code>-</code> can be specified at the start or the end of the list, for example <code>[a-z-]</code><li><code>^</code> should be other than the first character, for example <code>[+a^.]</code><li><code>]</code> should be the first character, for example <code>[]a-z]</code> and <code>[^]a]</code></ul><h2 id=replacement-expressions><a class=header href=#replacement-expressions>Replacement expressions</a></h2><ul><li><code>\=</code> when <code>replacestring</code> starts with <code>\=</code>, it is treated as an expression<li><code>s/\d\+/\=submatch(0)*2/g</code> multiplies matching numbers by 2 <ul><li>for example, changes <code>4 and 10</code> to <code>8 and 20</code><li><code>submatch()</code> function is similar to backreferences, <code>0</code> gives the entire matched string, <code>1</code> refers to the first capture group and so on</ul><li><code>s/"[^"]\+"/\=substitute(submatch(0), '[aeiou]', '\u&', 'g')/g</code> affects vowels only inside double quotes <ul><li>for example, changes <code>"mango" and "guava"</code> to <code>"mAngO" and "gUAvA"</code><li><code>substitute()</code> function works similarly to the <code>s</code> command<li>first argument is the text to work on<li>second argument is similar to <code>searchpattern</code><li>third argument is similar to <code>replacestring</code><li>fourth argument is flags, use empty string if not required<li>see <a href=https://vimhelp.org/builtin.txt.html#substitute%28%29>:h substitute()</a> for more details and differences compared to the <code>s</code> command</ul><li><code>perldo s/\d+/$&*2/ge</code> changes <code>4 and 10</code> to <code>8 and 20</code> <ul><li>useful if you are familiar with Perl regular expressions and <code>perl</code> interface is available with your Vim installation<li>note that the default range is <code>1,$</code> (the <code>s</code> command works only on the current line by default)<li>see <a href=https://vimhelp.org/if_perl.txt.html#%3Aperldo>:h perldo</a> for restrictions and more details</ul></ul><blockquote><p><img src=./images/info.svg alt=info> See <a href=https://vimhelp.org/usr_41.txt.html>:h usr_41.txt</a> for details about Vim script.</blockquote><blockquote><p><img src=./images/info.svg alt=info> See <a href=https://vimhelp.org/change.txt.html#sub-replace-expression>:h sub-replace-expression</a> for more details.</blockquote><blockquote><p><img src=./images/info.svg alt=info> See also <a href=https://stackoverflow.com/q/35915448/4082052>stackoverflow: find all occurrences and replace with user input</a>.</blockquote><h2 id=further-reading><a class=header href=#further-reading>Further Reading</a></h2><ul><li><a href=https://vi.stackexchange.com/q/13689/1616>vi.stackexchange: How to find and replace in Vim without having to type the original word?</a> — lots of tips and tricks<li><a href=https://vi.stackexchange.com/q/12867/1616>vi.stackexchange: How to replace each match with incrementing counter?</a><li><a href=https://vi.stackexchange.com/q/9386/1616>vi.stackexchange: What is the rationale for \r and \n meaning different things in s command?</a> and <a href=https://stackoverflow.com/q/71417/4082052>stackoverflow: Why is \r a newline for Vim?</a></ul></main><nav class=nav-wrapper aria-label="Page navigation"><a rel=prev href=Visual-mode.html class="mobile-nav-chapters previous"title="Previous chapter"aria-label="Previous chapter"aria-keyshortcuts=Left> <i class="fa fa-angle-left"></i> </a><a rel=next href=Macro.html class="mobile-nav-chapters next"title="Next chapter"aria-label="Next chapter"aria-keyshortcuts=Right> <i class="fa fa-angle-right"></i> </a><div style="clear: both"></div></nav></div></div><nav class=nav-wide-wrapper aria-label="Page navigation"><a rel=prev href=Visual-mode.html class="nav-chapters previous"title="Previous chapter"aria-label="Previous chapter"aria-keyshortcuts=Left> <i class="fa fa-angle-left"></i> </a><a rel=next href=Macro.html class="nav-chapters next"title="Next chapter"aria-label="Next chapter"aria-keyshortcuts=Right> <i class="fa fa-angle-right"></i> </a></nav></div><script>
            window.playground_copyable = true;
        </script><script src=elasticlunr.min.js charset=utf-8></script><script src=mark.min.js charset=utf-8></script><script src=searcher.js charset=utf-8></script><script src=clipboard.min.js charset=utf-8></script><script src=highlight.js charset=utf-8></script><script src=book.js charset=utf-8></script><script src=sidebar.js></script>